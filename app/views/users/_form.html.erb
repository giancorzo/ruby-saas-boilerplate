<% content_for :scripts do %>
  <script type="text/javascript">
    $(document).ready(function () {
      $('#user_avatar').on('change', function(event) {
        var files = event.target.files;
        var image = files[0]
        var reader = new FileReader();
        reader.onload = function(file) {
          var img = new Image();
          console.log(file);
          img.src = file.target.result;
          $('#target').html(img);
        }
        reader.readAsDataURL(image);
        console.log(files);
      });
    });
  </script>
<% end %>
<%= simple_form_for @user, :html => { class: "form-horizontal"} do |f| %>
<div class="row">
  <div class="col-lg-12">
    <div class="hpanel hblue">
      <div class="panel-heading hbuilt">
        <div class="panel-tools">
            <a class="showhide"><i class="fa fa-chevron-up"></i></a>
            <a class="closebox"><i class="fa fa-times"></i></a>
        </div>
        Profile Picture
      </div>
      <div class="panel-body">
        <div class="form-group">
          <div class="col-sm-1">
            <div id="target" class="profile-edit-image">
              <%= image_tag @user.avatar.url(:thumb) if @user.avatar.exists? %>
              <%= @user.name[0] if !@user.avatar.exists? %>
            </div>
          </div>
          <div class="col-sm-11">
            <h4>Upload your photo...</h4>
            <p>Photo should be at least 300px x 300px</p>
            <label for="user_avatar" class="custom-file-upload">
                <i class="fa fa-cloud-upload"></i> Upload photo
            </label>
            <%= f.input :avatar, label: false, :input_html => {style: "display:none;"} %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-lg-6">
    <div class="hpanel hblue">
      <div class="panel-heading hbuilt">
        <div class="panel-tools">
            <a class="showhide"><i class="fa fa-chevron-up"></i></a>
            <a class="closebox"><i class="fa fa-times"></i></a>
        </div>
        Basic information
      </div>
      <div class="panel-body">
        <div class="form-group">
          <%= f.label :name, class: "col-sm-2 control-label", required:false %>
          <div class="col-sm-10">
            <%= f.input :name, label: false, :input_html => {class: "form-control"} %>
          </div>
        </div>
        <div class="form-group">
          <%= f.label :email, class: "col-sm-2 control-label", required:false %>
          <div class="col-sm-10">
            <%= f.input :email, label: false, :input_html => {class: "form-control"} %>
          </div>
        </div>
        <div class="form-group">
          <%= f.label :role, class: "col-sm-2 control-label", required:false %>
          <div class="col-sm-10">
            <%= f.input :role, label: false,collection: User.roles.keys, :include_blank => "Selecciona un rol", :input_html => {class: "form-control"} %>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-lg-6">
    <div class="hpanel hblue">
      <div class="panel-heading hbuilt">
        <div class="panel-tools">
            <a class="showhide"><i class="fa fa-chevron-up"></i></a>
            <a class="closebox"><i class="fa fa-times"></i></a>
        </div>
        Change Password
      </div>
      <div class="panel-body">
        <div class="form-group">
          <%= f.label :password, "New Password", class: "col-sm-2 control-label", required:false %>
          <div class="col-sm-10">
            <%= f.input :password, label: false, :input_html => {class: "form-control", autocomplete: "off"} %>
          </div>
        </div>
        <div class="form-group">
          <%= f.label :password_confirmation, "Confirm new password", class: "col-sm-2 control-label", required:false %>
          <div class="col-sm-10">
            <%= f.input :password_confirmation, label: false, :input_html => {class: "form-control", autocomplete: "off"} %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="form-actions">
  <%= f.button :submit,class: "btn btn-primary" %>
</div>
<% end %>
